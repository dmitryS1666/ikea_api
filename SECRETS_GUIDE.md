# üîê –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–µ–∫—Ä–µ—Ç–∞–º –∏ –ø–∞—Ä–æ–ª—è–º

## üìã –î–≤–∞ —Ç–∏–ø–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 1. `.env` - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Docker Compose)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/home/sushi/Documents/ikea_api/.env`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —á–µ—Ä–µ–∑ Docker Compose.

**–°–æ–∑–¥–∞–Ω–∏–µ:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
nano .env
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `.env` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```env
# –ü–æ—Ä—Ç—ã (–¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∂–µ –≤ docker-compose.yml)
POSTGRES_PORT=55432
REDIS_PORT=6479
MONGODB_PORT=27017
RAILS_PORT=3000

# JWT Secret (–º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å)
JWT_SECRET=change_me_to_secret_key_please

# Redis –ø–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
REDIS_PASSWORD=

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ Rails
RAILS_MAX_THREADS=5
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT_SECRET:**
```bash
ruby -e "require 'securerandom'; puts SecureRandom.hex(64)"
```

---

### 2. `.kamal/secrets` - –¥–ª—è production –¥–µ–ø–ª–æ—è (Kamal)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/home/sushi/Documents/ikea_api/.kamal/secrets`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–µ–∫—Ä–µ—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ production —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ Kamal.

**–°–æ–∑–¥–∞–Ω–∏–µ:**
```bash
mkdir -p .kamal

cat > .kamal/secrets << EOF
RAILS_MASTER_KEY=$(rails secret)
DB_USERNAME=postgres
DB_PASSWORD=–í–ê–®_–ü–ê–†–û–õ–¨_POSTGRES
REDIS_PASSWORD=
JWT_SECRET=$(ruby -e "require 'securerandom'; puts SecureRandom.hex(64)")
POSTGRES_PASSWORD=–í–ê–®_–ü–ê–†–û–õ–¨_POSTGRES
KAMAL_REGISTRY_PASSWORD=–í–ê–®_DOCKER_HUB_–¢–û–ö–ï–ù_–ó–î–ï–°–¨
EOF
```

---

## üîë –ì–¥–µ –≤–∑—è—Ç—å –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã?

### 1. `DB_PASSWORD` –∏ `POSTGRES_PASSWORD`

**–≠—Ç–æ –ø–∞—Ä–æ–ª–∏ –¥–ª—è PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.**

–í—ã –¥–æ–ª–∂–Ω—ã **–ø—Ä–∏–¥—É–º–∞—Ç—å –∏—Ö —Å–∞–º–∏** - —ç—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ú–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 32+)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç—ã–µ –ø–∞—Ä–æ–ª–∏ —Ç–∏–ø–∞ "password123"
- –ü–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
# –ß–µ—Ä–µ–∑ openssl (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ä–æ–ª—å)
openssl rand -base64 32

# –ò–ª–∏ —á–µ—Ä–µ–∑ Ruby
ruby -e "require 'securerandom'; puts SecureRandom.hex(32)"
```

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π:**
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
DB_PASSWORD=$(openssl rand -base64 32)
POSTGRES_PASSWORD=$(openssl rand -base64 32)  # –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –ø–∞—Ä–æ–ª—å –∏–ª–∏ —Ä–∞–∑–Ω—ã–µ

# –ò–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –ø–∞—Ä–æ–ª—å –¥–ª—è –æ–±–æ–∏—Ö (–ø—Ä–æ—â–µ, –Ω–æ –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)
# DB_PASSWORD=$(openssl rand -base64 32)
# POSTGRES_PASSWORD=$DB_PASSWORD
```

**–í–∞–∂–Ω–æ:** 
- –ü–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏** (—Å–ª—É—á–∞–π–Ω—ã–º–∏)
- –ü–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ** - –æ–Ω–∏ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

---

### 2. `KAMAL_REGISTRY_PASSWORD`

**–≠—Ç–æ —Ç–æ–∫–µ–Ω –¥–ª—è Docker Hub (–∏–ª–∏ –ø–∞—Ä–æ–ª—å).**

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Hub Personal Access Token (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://hub.docker.com/settings/security
2. –ù–∞–∂–º–∏—Ç–µ "New Access Token"
3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ "Read, Write, Delete"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω (–æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –∫–∞–∫ `KAMAL_REGISTRY_PASSWORD`

#### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker Hub –ø–∞—Ä–æ–ª—å

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à –ø–∞—Ä–æ–ª—å –æ—Ç Docker Hub, –Ω–æ —ç—Ç–æ –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

**–í–∞—à Docker Hub username:** `dmitryS1666` (–∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)

---

### 3. `RAILS_MASTER_KEY`

**–≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:**
```bash
rails secret
```

–ü—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

### 4. `JWT_SECRET`

**–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:**
```bash
ruby -e "require 'securerandom'; puts SecureRandom.hex(64)"
```

---

### 5. `REDIS_PASSWORD`

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.** –ï—Å–ª–∏ Redis –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–æ–ª—å, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º:
```env
REDIS_PASSWORD=
```

–ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å:
```bash
openssl rand -base64 32
```

---

## üìù –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è `.kamal/secrets`

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p .kamal

# 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª–∏
DB_PASSWORD=$(openssl rand -base64 32)
POSTGRES_PASSWORD=$DB_PASSWORD
JWT_SECRET=$(ruby -e "require 'securerandom'; puts SecureRandom.hex(64)")
RAILS_MASTER_KEY=$(rails secret)

# 3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª (–∑–∞–º–µ–Ω–∏—Ç–µ YOUR_DOCKER_HUB_TOKEN –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω)
cat > .kamal/secrets << EOF
RAILS_MASTER_KEY=$RAILS_MASTER_KEY
DB_USERNAME=postgres
DB_PASSWORD=$DB_PASSWORD
REDIS_PASSWORD=
JWT_SECRET=$JWT_SECRET
POSTGRES_PASSWORD=$POSTGRES_PASSWORD
KAMAL_REGISTRY_PASSWORD=YOUR_DOCKER_HUB_TOKEN
EOF

# 4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ git
echo ".kamal/secrets" >> .gitignore
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **`.env`** - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –º–æ–∂–Ω–æ –∫–æ–º–º–∏—Ç–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã (`.env.example`)
2. **`.kamal/secrets`** - –ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ git! –≠—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
3. **–ü–∞—Ä–æ–ª–∏** - –ø—Ä–∏–¥—É–º–∞–π—Ç–µ —Å–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã
4. **Docker Hub —Ç–æ–∫–µ–Ω** - —Å–æ–∑–¥–∞–π—Ç–µ –Ω–∞ https://hub.docker.com/settings/security

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ .env (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
ls -la .env

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .kamal/secrets (production)
ls -la .kamal/secrets

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ (–±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã!)
cat .env
cat .kamal/secrets
```

